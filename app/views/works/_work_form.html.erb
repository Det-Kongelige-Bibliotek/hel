<div class="work editMode" data-hook="work-form">

  <div class="page-header">
    <div class="container">
      <button type="button" class="btn btn-primary pull-right" data-toggle="modal" data-target="#myModal">
        <span class="glyphicon glyphicon-import"></span>
        <%= t('.import') %>
      </button>
      <h1><%= t('.work') %> <small id="headerTitle"><%= @work.title_values.first %></small></h1>

    </div>
  </div>

  <div class="container">
    <%= simple_form_for(@work, html: { novalidate: true },  defaults: { wrapper_html: { class: 'form-group' },
                                                                        input_html: { class: 'form-control' } }
        ) do |f| %>
        <%= @work.errors.messages if @work.errors.present? %>
        <fieldset class="row">
          <legend class="col-sm-12"><%= t('.titles') %></legend>
          <%= render  partial: 'works/title',  locals: { work_form: f } %>

          <div class='col-sm-12'>
            <a class="btn btn-sm btn-success" href="#" data-function="clone-fields" data-selector=".title_fields:last">
              <span class="glyphicon glyphicon-plus"></span>
              <%= t('.add_title') %>
            </a>
          </div>
        </fieldset>
        <fieldset class="row">
          <legend class="col-sm-12">
            <%= t('.author') %>
            <a class="btn btn-sm btn-primary pull-right" data-toggle="modal" href="#new_agent_modal">
              <span class="glyphicon glyphicon-plus"></span>
              <%= t('.new_person') %>
            </a>
          </legend>

          <%= render partial: 'relators/form', locals: { builder: f } %>

          <div class='col-sm-12'>
            <a class="btn btn-sm btn-success" href="#" data-function="clone-fields" data-selector=".relator_fields:last">
              <span class="glyphicon glyphicon-plus"></span>
              <%= t('.add_author') %>
            </a>
          </div>
        </fieldset>
        <fieldset class="row col-sm-12">
          <legend><%= t('.language') %> </legend>
          <div class="col-sm-3">
            <%= f.input :language, collection: get_list_with_labels('Languages'), label: false,
                        prompt: 'Vælg sprog', input_html: { class: 'form-control combobox' }
            %>
          </div>
        </fieldset>
        <fieldset class="row col-sm-12">
          <legend class="col-sm-12"><%= t('works.show.origin_date') %> </legend>
          <div class="col-sm-3">
            <%= f.input :origin_date, label: false %>
          </div>
        </fieldset>
        <fieldset class="row col-sm-12">
          <legend class="col-sm-12"><%#= t('.subject') %></legend>
          <%# if @work.subjects.size > 0  %>
          <%# @work.subjects.each_with_index do |subject,index| %>
          <%#= render  partial: 'works/subject_authority',  locals: {subject: subject , index: index, hidden:false} %>
          <%# end%>
          <%#= render partial: 'works/subject_authority', locals: {subject: nil , index: @work.subjects.size, hidden:true} %>
          <%# else %>
          <%#= render partial: 'works/subject_authority', locals: {subject: nil , index: 0, hidden:false} %>
          <%#= render partial: 'works/subject_authority', locals: {subject: nil , index: 1, hidden:true} %>
          <%# end %>
<!--
          <div class='col-sm-12'>
            <a class="btn btn-sm btn-success" href="#" data-function="new-subject">
              <span class="glyphicon glyphicon-plus"></span>
              <%#= t('.add_subject') %>
            </a>
          </div>
-->
        </fieldset>

        <div class='col-sm-12'>
        </div>

        <div class="actions col-sm-offset-9">
          <%= link_to t('.cancel'), :back, class: 'btn btn-lg btn-warning'%>
          <%= f.submit 'Gem værk',  class: 'btn btn-lg btn-success'%>
        </div>
    <% end %>
  </div>
</div>

<%= render partial: 'works/new_agent_modal' %>
<%= render partial: 'works/aleph_import' %>

